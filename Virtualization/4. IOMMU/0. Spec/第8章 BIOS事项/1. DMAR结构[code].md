
定义的 drhd 链表

```cpp
// drivers/iommu/intel/dmar.c
LIST_HEAD(dmar_drhd_units);
```

在 iommu 初始化或者 irq remapping 初始化时候, 会对 dmar table 进行初始化

```cpp
// drivers/iommu/intel/iommu.c
intel_iommu_init() ->
// drivers/iommu/intel/irq_remapping.c
intel_prepare_irq_remapping() ->


// drivers/iommu/intel/dmar.c
// dmar table 初始化
dmar_table_init() ->
// 解析 DMA reporting table
parse_dmar_table()
```

```cpp
// include/acpi/actbl.h
struct acpi_table_header {
	char signature[ACPI_NAMESEG_SIZE];	/* ASCII table signature */
	u32 length;		/* Length of table in bytes, including this header */
	u8 revision;		/* ACPI Specification minor version number */
	u8 checksum;		/* To make sum of entire table == 0 */
	char oem_id[ACPI_OEM_ID_SIZE];	/* ASCII OEM identification */
	char oem_table_id[ACPI_OEM_TABLE_ID_SIZE];	/* ASCII OEM table identification */
	u32 oem_revision;	/* OEM revision number */
	char asl_compiler_id[ACPI_NAMESEG_SIZE];	/* ASCII ASL compiler vendor ID */
	u32 asl_compiler_revision;	/* ASL compiler version */
};

// drivers/iommu/intel/dmar.c
struct acpi_table_header * __initdata dmar_tbl;

static int __init
parse_dmar_table(void)
{
    struct acpi_table_dmar *dmar;
    // 探测 dmar table
	dmar_table_detect();

	dmar_tbl = tboot_get_dmar_table(dmar_tbl);

    dmar = (struct acpi_table_dmar *)dmar_tbl;

}
```



```cpp
dmar_walk_dmar_table() ->
dmar_parse_one_drhd() ->
dmar_register_drhd_unit()
```
